---
id: runner
title: المشغِّل
---

import CodeBlock from '@theme/CodeBlock';

المشغِّل في WebdriverIO ينظم كيفية ومكان تشغيل الاختبارات عند استخدام testrunner. يدعم WebdriverIO حاليًا نوعين مختلفين من المشغلات: المشغل المحلي ومشغل المتصفح.

## المشغل المحلي

يبدأ [المشغل المحلي](https://www.npmjs.com/package/@wdio/local-runner) إطار العمل الخاص بك (مثل Mocha أو Jasmine أو Cucumber) ضمن عملية العامل ويشغل جميع ملفات الاختبار الخاصة بك داخل بيئة Node.js. يتم تشغيل كل ملف اختبار في عملية عامل منفصلة لكل قدرة مما يسمح بأقصى قدر من التزامن. تستخدم كل عملية عامل مثيلاً واحداً من المتصفح وبالتالي تشغل جلسة المتصفح الخاصة بها مما يسمح بأقصى قدر من العزل.

نظرًا لأن كل اختبار يتم تشغيله في عملية معزولة خاصة به، فإنه من غير الممكن مشاركة البيانات عبر ملفات الاختبار. هناك طريقتان للتغلب على هذا:

- استخدم [`@wdio/shared-store-service`](https://www.npmjs.com/package/@wdio/shared-store-service) لمشاركة البيانات عبر جميع العمال
- تجميع ملفات المواصفات (اقرأ المزيد في [تنظيم مجموعة الاختبار](https://webdriver.io/docs/organizingsuites#grouping-test-specs-to-run-sequentially))

إذا لم يتم تحديد أي شيء آخر في `wdio.conf.js`، فإن المشغل المحلي هو المشغل الافتراضي في WebdriverIO.

### التثبيت

لاستخدام المشغل المحلي يمكنك تثبيته عبر:

```sh
npm install --save-dev @wdio/local-runner
```

### الإعداد

المشغل المحلي هو المشغل الافتراضي في WebdriverIO لذلك لا حاجة لتعريفه داخل ملف `wdio.conf.js`. إذا كنت ترغب في تعيينه بشكل صريح، يمكنك تعريفه على النحو التالي:

```js
// wdio.conf.js
export const {
    // ...
    runner: 'local',
    // ...
}
```

## مشغل المتصفح

على عكس [المشغل المحلي](https://www.npmjs.com/package/@wdio/local-runner)، يقوم [مشغل المتصفح](https://www.npmjs.com/package/@wdio/browser-runner) ببدء وتنفيذ إطار العمل داخل المتصفح. هذا يسمح لك بتشغيل اختبارات الوحدة أو اختبارات المكونات في متصفح حقيقي بدلاً من JSDOM مثل العديد من أطر الاختبار الأخرى.

بينما يُستخدم [JSDOM](https://www.npmjs.com/package/jsdom) على نطاق واسع لأغراض الاختبار، فإنه في النهاية ليس متصفحًا حقيقيًا ولا يمكنك محاكاة بيئات الجوال به. من خلال هذا المشغل، يمكّنك WebdriverIO من تشغيل اختباراتك بسهولة في المتصفح واستخدام أوامر WebDriver للتفاعل مع العناصر المعروضة على الصفحة.

فيما يلي نظرة عامة على تشغيل الاختبارات داخل JSDOM مقابل مشغل متصفح WebdriverIO

| | JSDOM | مشغل متصفح WebdriverIO |
|-|-------|----------------------------|
|1.| يشغل اختباراتك داخل Node.js باستخدام إعادة تنفيذ معايير الويب، وبشكل خاص معايير WHATWG DOM و HTML | ينفذ اختبارك في متصفح حقيقي ويشغل الكود في بيئة يستخدمها المستخدمون |
|2.| يمكن محاكاة التفاعلات مع المكونات فقط عبر JavaScript | يمكنك استخدام [واجهة برمجة تطبيقات WebdriverIO](api) للتفاعل مع العناصر من خلال بروتوكول WebDriver |
|3.| دعم Canvas يتطلب [تبعيات إضافية](https://www.npmjs.com/package/canvas) و[له قيود](https://github.com/Automattic/node-canvas/issues) | لديك إمكانية الوصول إلى [واجهة برمجة تطبيقات Canvas](https://developer.mozilla.org/en-US/docs/Web/API/Canvas_API) الحقيقية |
|4.| لدى JSDOM بعض [التحذيرات](https://github.com/jsdom/jsdom#caveats) وواجهات برمجة تطبيقات الويب غير المدعومة | جميع واجهات برمجة تطبيقات الويب مدعومة حيث يتم تشغيل الاختبار في متصفح حقيقي |
|5.| من المستحيل اكتشاف الأخطاء عبر المتصفحات المختلفة | دعم لجميع المتصفحات بما في ذلك متصفحات الجوال |
|6.| __لا يمكن__ اختبار حالات العناصر الزائفة | دعم للحالات الزائفة مثل `:hover` أو `:active` |

يستخدم هذا المشغل [Vite](https://vitejs.dev/) لتجميع كود الاختبار الخاص بك وتحميله في المتصفح. يأتي مع إعدادات مسبقة لأطر عمل المكونات التالية:

- React
- Preact
- Vue.js
- Svelte
- SolidJS
- Stencil

كل ملف اختبار / مجموعة ملفات اختبار تعمل داخل صفحة واحدة مما يعني أنه بين كل اختبار يتم إعادة تحميل الصفحة لضمان العزل بين الاختبارات.

### التثبيت

لاستخدام مشغل المتصفح يمكنك تثبيته عبر:

```sh
npm install --save-dev @wdio/browser-runner
```

### الإعداد

لاستخدام مشغل المتصفح، يجب عليك تحديد خاصية `runner` داخل ملف `wdio.conf.js` الخاص بك، على سبيل المثال:

```js
// wdio.conf.js
export const {
    // ...
    runner: 'browser',
    // ...
}
```

### خيارات المشغل

يسمح مشغل المتصفح بالتكوينات التالية:

#### `preset`

إذا كنت تختبر المكونات باستخدام أحد الأطر المذكورة أعلاه، يمكنك تحديد إعداد مسبق يضمن تكوين كل شيء من البداية. لا يمكن استخدام هذا الخيار مع `viteConfig`.

__النوع:__ `vue` | `svelte` | `solid` | `react` | `preact` | `stencil`<br />
__مثال:__

```js title="wdio.conf.js"
export const {
    // ...
    runner: ['browser', {
        preset: 'svelte'
    }],
    // ...
}
```

#### `viteConfig`

حدد [تكوين Vite](https://vitejs.dev/config/) الخاص بك. يمكنك إما تمرير كائن مخصص أو استيراد ملف `vite.conf.ts` موجود إذا كنت تستخدم Vite.js للتطوير. لاحظ أن WebdriverIO يحتفظ بتكوينات Vite المخصصة لإعداد بيئة الاختبار.

__النوع:__ `string` أو [`UserConfig`](https://github.com/vitejs/vite/blob/52e64eb43287d241f3fd547c332e16bd9e301e95/packages/vite/src/node/config.ts#L119-L272) أو `(env: ConfigEnv) => UserConfig | Promise<UserConfig>`<br />
__مثال:__

```js title="wdio.conf.ts"
import viteConfig from '../vite.config.ts'

export const {
    // ...
    runner: ['browser', { viteConfig }],
    // أو ببساطة:
    runner: ['browser', { viteConfig: '../vites.config.ts' }],
    // أو استخدم دالة إذا كان تكوين vite يحتوي على الكثير من المكونات الإضافية
    // التي تريد حلها فقط عند قراءة القيمة
    runner: ['browser', {
        viteConfig: () => ({
            // ...
        })
    }],
    // ...
}
```

#### `headless`

إذا تم تعيينه على `true`، سيقوم المشغل بتحديث الإمكانيات لتشغيل الاختبارات بدون واجهة. بشكل افتراضي، يتم تمكين هذا في بيئات CI حيث يتم تعيين متغير البيئة `CI` إلى `'1'` أو `'true'`.

__النوع:__ `boolean`<br />
__القيمة الافتراضية:__ `false`، تُعين إلى `true` إذا تم تعيين متغير البيئة `CI`

#### `rootDir`

دليل جذر المشروع.

__النوع:__ `string`<br />
__القيمة الافتراضية:__ `process.cwd()`

#### `coverage`

يدعم WebdriverIO الإبلاغ عن تغطية الاختبار من خلال [`istanbul`](https://istanbul.js.org/). انظر [خيارات التغطية](#coverage-options) لمزيد من التفاصيل.

__النوع:__ `object`<br />
__القيمة الافتراضية:__ `undefined`

### خيارات التغطية

الخيارات التالية تسمح بتكوين تقارير التغطية.

#### `enabled`

يُمكّن جمع التغطية.

__النوع:__ `boolean`<br />
__القيمة الافتراضية:__ `false`

#### `include`

قائمة الملفات المضمنة في التغطية كأنماط glob.

__النوع:__ `string[]`<br />
__القيمة الافتراضية:__ `[**]`

#### `exclude`

قائمة الملفات المستبعدة من التغطية كأنماط glob.

__النوع:__ `string[]`<br />
__القيمة الافتراضية:__

```
[
  'coverage/**',
  'dist/**',
  'packages/*/test{,s}/**',
  '**/*.d.ts',
  'cypress/**',
  'test{,s}/**',
  'test{,-*}.{js,cjs,mjs,ts,tsx,jsx}',
  '**/*{.,-}test.{js,cjs,mjs,ts,tsx,jsx}',
  '**/*{.,-}spec.{js,cjs,mjs,ts,tsx,jsx}',
  '**/__tests__/**',
  '**/{karma,rollup,webpack,vite,vitest,jest,ava,babel,nyc,cypress,tsup,build}.config.*',
  '**/.{eslint,mocha,prettier}rc.{js,cjs,yml}',
]
```

#### `extension`

قائمة امتدادات الملفات التي يجب أن يتضمنها التقرير.

__النوع:__ `string | string[]`<br />
__القيمة الافتراضية:__ `['.js', '.cjs', '.mjs', '.ts', '.mts', '.cts', '.tsx', '.jsx', '.vue', '.svelte']`

#### `reportsDirectory`

الدليل الذي يتم كتابة تقرير التغطية إليه.

__النوع:__ `string`<br />
__القيمة الافتراضية:__ `./coverage`

#### `reporter`

مراسلو التغطية المستخدمون. راجع [وثائق istanbul](https://istanbul.js.org/docs/advanced/alternative-reporters/) للحصول على قائمة مفصلة بجميع المراسلين.

__النوع:__ `string[]`<br />
__القيمة الافتراضية:__ `['text', 'html', 'clover', 'json-summary']`

#### `perFile`

تحقق من العتبات لكل ملف. انظر `lines` و `functions` و `branches` و `statements` للعتبات الفعلية.

__النوع:__ `boolean`<br />
__القيمة الافتراضية:__ `false`

#### `clean`

تنظيف نتائج التغطية قبل تشغيل الاختبارات.

__النوع:__ `boolean`<br />
__القيمة الافتراضية:__ `true`

#### `lines`

عتبة للأسطر.

__النوع:__ `number`<br />
__القيمة الافتراضية:__ `undefined`

#### `functions`

عتبة للدوال.

__النوع:__ `number`<br />
__القيمة الافتراضية:__ `undefined`

#### `branches`

عتبة للفروع.

__النوع:__ `number`<br />
__القيمة الافتراضية:__ `undefined`

#### `statements`

عتبة للعبارات.

__النوع:__ `number`<br />
__القيمة الافتراضية:__ `undefined`

### القيود

عند استخدام مشغل متصفح WebdriverIO، من المهم ملاحظة أن مربعات الحوار التي تحظر التنفيذ مثل `alert` أو `confirm` لا يمكن استخدامها بشكل أصلي. هذا لأنها تحظر صفحة الويب، مما يعني أن WebdriverIO لا يمكنه الاستمرار في التواصل مع الصفحة، مما يتسبب في تعليق التنفيذ.

في مثل هذه الحالات، يوفر WebdriverIO وهميات افتراضية بقيم مرجعة افتراضية لواجهات برمجة التطبيقات هذه. يضمن ذلك أنه إذا استخدم المستخدم عن طريق الخطأ واجهات برمجة تطبيقات الويب المتزامنة للنوافذ المنبثقة، فإن التنفيذ لن يتوقف. ومع ذلك، لا يزال يُنصح المستخدم بعمل وهميات لواجهات برمجة تطبيقات الويب هذه للحصول على تجربة أفضل. اقرأ المزيد في [المحاكاة](/docs/component-testing/mocking).

### أمثلة

تأكد من الاطلاع على الوثائق حول [اختبار المكونات](https://webdriver.io/docs/component-testing) وإلقاء نظرة على [مستودع الأمثلة](https://github.com/webdriverio/component-testing-examples) لأمثلة استخدام هذه وأطر عمل أخرى متنوعة.