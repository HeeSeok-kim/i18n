---
id: organizingsuites
title: تنظيم مجموعة الاختبارات
---

مع نمو المشاريع، تتم إضافة المزيد والمزيد من اختبارات التكامل حتماً. هذا يزيد من وقت البناء ويبطئ الإنتاجية.

لمنع ذلك، يجب أن تقوم بتشغيل اختباراتك بالتوازي. يقوم WebdriverIO بالفعل باختبار كل ملف مواصفات (أو _ملف ميزة_ في Cucumber) بالتوازي داخل جلسة واحدة. بشكل عام، حاول اختبار ميزة واحدة فقط لكل ملف مواصفات. حاول ألا يكون لديك اختبارات كثيرة جداً أو قليلة جداً في ملف واحد. (ومع ذلك، لا توجد قاعدة ذهبية هنا.)

بمجرد أن تحتوي اختباراتك على عدة ملفات مواصفات، يجب أن تبدأ في تشغيل اختباراتك بالتزامن. للقيام بذلك، اضبط خاصية `maxInstances` في ملف التكوين الخاص بك. يسمح لك WebdriverIO بتشغيل اختباراتك بأقصى قدر من التزامن - مما يعني أنه بغض النظر عن عدد الملفات والاختبارات التي لديك، يمكن تشغيلها جميعًا بالتوازي. (هذا لا يزال خاضعًا لبعض القيود، مثل وحدة المعالجة المركزية للكمبيوتر وقيود التزامن وما إلى ذلك).

> لنفترض أن لديك 3 قدرات مختلفة (Chrome و Firefox و Safari) وقمت بتعيين `maxInstances` إلى `1`. سيقوم مشغل اختبار WDIO بإنشاء 3 عمليات. لذلك، إذا كان لديك 10 ملفات مواصفات وقمت بتعيين `maxInstances` إلى `10`، سيتم اختبار _جميع_ ملفات المواصفات في وقت واحد، وسيتم إنشاء 30 عملية.

يمكنك تعريف خاصية `maxInstances` عالمياً لتعيين السمة لجميع المتصفحات.

إذا كنت تقوم بتشغيل شبكة WebDriver الخاصة بك، قد يكون لديك (على سبيل المثال) قدرة أكبر لمتصفح واحد أكثر من الآخر. في تلك الحالة، يمكنك _تحديد_ `maxInstances` في كائن القدرة الخاص بك:

```js
// wdio.conf.js
export const config = {
    // ...
    // set maxInstance for all browser
    maxInstances: 10,
    // ...
    capabilities: [{
        browserName: 'firefox'
    }, {
        // maxInstances can get overwritten per capability. So if you have an in-house WebDriver
        // grid with only 5 firefox instance available you can make sure that not more than
        // 5 instance gets started at a time.
        browserName: 'chrome'
    }],
    // ...
}
```

## الوراثة من ملف التكوين الرئيسي

إذا كنت تقوم بتشغيل مجموعة الاختبارات الخاصة بك في بيئات متعددة (مثل بيئة التطوير والتكامل)، فقد يساعد استخدام ملفات تكوين متعددة في إبقاء الأمور قابلة للإدارة.

بشكل مشابه لـ [مفهوم كائن الصفحة](pageobjects)، الشيء الأول الذي ستحتاجه هو ملف تكوين رئيسي. يحتوي على جميع التكوينات التي تشاركها عبر البيئات.

ثم قم بإنشاء ملف تكوين آخر لكل بيئة، وقم بتكملة التكوين الرئيسي بالبيئات المحددة:

```js
// wdio.dev.config.js
import { deepmerge } from 'deepmerge-ts'
import wdioConf from './wdio.conf.js'

// have main config file as default but overwrite environment specific information
export const config = deepmerge(wdioConf.config, {
    capabilities: [
        // more caps defined here
        // ...
    ],

    // run tests on sauce instead locally
    user: process.env.SAUCE_USERNAME,
    key: process.env.SAUCE_ACCESS_KEY,
    services: ['sauce']
}, { clone: false })

// add an additional reporter
config.reporters.push('allure')
```

## تجميع مواصفات الاختبار في مجموعات

يمكنك تجميع مواصفات الاختبار في مجموعات وتشغيل مجموعات محددة فردية بدلاً من تشغيلها جميعًا.

أولاً، حدد مجموعاتك في تكوين WDIO الخاص بك:

```js
// wdio.conf.js
export const config = {
    // define all tests
    specs: ['./test/specs/**/*.spec.js'],
    // ...
    // define specific suites
    suites: {
        login: [
            './test/specs/login.success.spec.js',
            './test/specs/login.failure.spec.js'
        ],
        otherFeature: [
            // ...
        ]
    },
    // ...
}
```

الآن، إذا كنت ترغب في تشغيل مجموعة واحدة فقط، يمكنك تمرير اسم المجموعة كوسيطة CLI:

```sh
wdio wdio.conf.js --suite login
```

أو قم بتشغيل مجموعات متعددة في وقت واحد:

```sh
wdio wdio.conf.js --suite login --suite otherFeature
```

## تجميع مواصفات الاختبار لتشغيلها بالتسلسل

كما هو موضح أعلاه، هناك فوائد في تشغيل الاختبارات بشكل متزامن. ومع ذلك، هناك حالات يكون فيها من المفيد تجميع الاختبارات معًا لتشغيلها بالتسلسل في مثيل واحد. أمثلة على ذلك هي بشكل رئيسي حيث توجد تكلفة إعداد كبيرة، مثل ترجمة الكود أو توفير نماذج السحابة، ولكن هناك أيضًا نماذج استخدام متقدمة تستفيد من هذه القدرة.

لتجميع الاختبارات لتشغيلها في مثيل واحد، قم بتعريفها كمصفوفة ضمن تعريف المواصفات.

```json
    "specs": [
        [
            "./test/specs/test_login.js",
            "./test/specs/test_product_order.js",
            "./test/specs/test_checkout.js"
        ],
        "./test/specs/test_b*.js",
    ],
```
في المثال أعلاه، سيتم تشغيل الاختبارات 'test_login.js' و 'test_product_order.js' و 'test_checkout.js' بشكل متسلسل في مثيل واحد وسيتم تشغيل كل من اختبارات "test_b*" بشكل متزامن في مثيلات فردية.

من الممكن أيضًا تجميع المواصفات المحددة في المجموعات، لذا يمكنك الآن أيضًا تحديد المجموعات بهذه الطريقة:
```json
    "suites": {
        end2end: [
            [
                "./test/specs/test_login.js",
                "./test/specs/test_product_order.js",
                "./test/specs/test_checkout.js"
            ]
        ],
        allb: ["./test/specs/test_b*.js"]
},
```
وفي هذه الحالة سيتم تشغيل جميع اختبارات مجموعة "end2end" في مثيل واحد.

عند تشغيل الاختبارات بالتسلسل باستخدام نمط، سيتم تشغيل ملفات المواصفات بترتيب أبجدي

```json
  "suites": {
    end2end: ["./test/specs/test_*.js"]
  },
```

سيؤدي ذلك إلى تشغيل الملفات المطابقة للنمط أعلاه بالترتيب التالي:

```
  [
      "./test/specs/test_checkout.js",
      "./test/specs/test_login.js",
      "./test/specs/test_product_order.js"
  ]
```

## تشغيل اختبارات محددة

في بعض الحالات، قد ترغب في تنفيذ اختبار واحد فقط (أو مجموعة فرعية من الاختبارات) من مجموعاتك.

باستخدام المعلمة `--spec`، يمكنك تحديد أي _مجموعة_ (Mocha، Jasmine) أو _ميزة_ (Cucumber) يجب تشغيلها. يتم حل المسار نسبيًا من دليل العمل الحالي الخاص بك.

على سبيل المثال، لتشغيل اختبار تسجيل الدخول فقط:

```sh
wdio wdio.conf.js --spec ./test/specs/e2e/login.js
```

أو قم بتشغيل مواصفات متعددة في وقت واحد:

```sh
wdio wdio.conf.js --spec ./test/specs/signup.js --spec ./test/specs/forgot-password.js
```

إذا كانت قيمة `--spec` لا تشير إلى ملف مواصفات معين، فسيتم استخدامها بدلاً من ذلك لتصفية أسماء ملفات المواصفات المحددة في تكوينك.

لتشغيل جميع المواصفات التي تحتوي على كلمة "dialog" في أسماء ملفات المواصفات، يمكنك استخدام:

```sh
wdio wdio.conf.js --spec dialog
```

لاحظ أن كل ملف اختبار يعمل في عملية تشغيل اختبار واحدة. نظرًا لأننا لا نقوم بمسح الملفات مسبقًا (راجع القسم التالي للحصول على معلومات حول توجيه أسماء الملفات إلى `wdio`)، _لا يمكنك_ استخدام (على سبيل المثال) `describe.only` في أعلى ملف المواصفات الخاص بك لتوجيه Mocha لتشغيل تلك المجموعة فقط.

ستساعدك هذه الميزة على تحقيق نفس الهدف.

عند توفير خيار `--spec`، سيتجاوز أي أنماط محددة بواسطة معلمة `specs` على مستوى التكوين أو القدرة.

## استبعاد اختبارات محددة

عند الحاجة، إذا كنت بحاجة إلى استبعاد ملف (ملفات) مواصفات معينة من التشغيل، يمكنك استخدام المعلمة `--exclude` (Mocha، Jasmine) أو الميزة (Cucumber).

على سبيل المثال، لاستبعاد اختبار تسجيل الدخول من تشغيل الاختبار:

```sh
wdio wdio.conf.js --exclude ./test/specs/e2e/login.js
```

أو استبعاد ملفات مواصفات متعددة:

 ```sh
wdio wdio.conf.js --exclude ./test/specs/signup.js --exclude ./test/specs/forgot-password.js
```

أو استبعاد ملف مواصفات عند التصفية باستخدام مجموعة:

```sh
wdio wdio.conf.js --suite login --exclude ./test/specs/e2e/login.js
```

إذا كانت قيمة `--exclude` لا تشير إلى ملف مواصفات معين، فسيتم استخدامها بدلاً من ذلك لتصفية أسماء ملفات المواصفات المحددة في تكوينك.

لاستبعاد جميع المواصفات التي تحتوي على كلمة "dialog" في أسماء ملفات المواصفات، يمكنك استخدام:

```sh
wdio wdio.conf.js --exclude dialog
```

عند توفير خيار `--exclude`، سيتجاوز أي أنماط محددة بواسطة معلمة `exclude` على مستوى التكوين أو القدرة.

## تشغيل المجموعات ومواصفات الاختبار

قم بتشغيل مجموعة كاملة جنبًا إلى جنب مع المواصفات الفردية.

```sh
wdio wdio.conf.js --suite login --spec ./test/specs/signup.js
```

## تشغيل مواصفات اختبار متعددة ومحددة

من الضروري أحيانًا - في سياق التكامل المستمر وغير ذلك - تحديد مجموعات متعددة من المواصفات لتشغيلها. تقبل أداة سطر أوامر `wdio` الخاصة بـ WebdriverIO أسماء الملفات المنقولة (من `find` أو `grep` أو غيرها).

تتجاوز أسماء الملفات المنقولة قائمة الأنماط الشاملة أو أسماء الملفات المحددة في قائمة `spec` الخاصة بالتكوين.

```sh
grep -r -l --include "*.js" "myText" | wdio wdio.conf.js
```

_**ملاحظة:** هذا لن_ يتجاوز علامة `--spec` لتشغيل مواصفات واحدة._

## تشغيل اختبارات محددة باستخدام MochaOpts

يمكنك أيضًا تصفية أي `suite|describe` و/أو `it|test` محددة ترغب في تشغيلها عن طريق تمرير وسيطة خاصة بـ mocha: `--mochaOpts.grep` إلى واجهة سطر أوامر wdio.

```sh
wdio wdio.conf.js --mochaOpts.grep myText
wdio wdio.conf.js --mochaOpts.grep "Text with spaces"
```

_**ملاحظة:** سيقوم Mocha بتصفية الاختبارات بعد أن ينشئ مشغل اختبار WDIO المثيلات، لذلك قد ترى العديد من المثيلات التي تم إنشاؤها ولكن لم يتم تنفيذها بالفعل._

## استبعاد اختبارات محددة باستخدام MochaOpts

يمكنك أيضًا تصفية أي `suite|describe` و/أو `it|test` محددة ترغب في استبعادها عن طريق تمرير وسيطة خاصة بـ mocha: `--mochaOpts.invert` إلى واجهة سطر أوامر wdio. يقوم `--mochaOpts.invert` بأداء عكس `--mochaOpts.grep`

```sh
wdio wdio.conf.js --mochaOpts.grep "string|regex" --mochaOpts.invert
wdio wdio.conf.js --spec ./test/specs/e2e/login.js --mochaOpts.grep "string|regex" --mochaOpts.invert
```

_**ملاحظة:** سيقوم Mocha بتصفية الاختبارات بعد أن ينشئ مشغل اختبار WDIO المثيلات، لذلك قد ترى العديد من المثيلات التي تم إنشاؤها ولكن لم يتم تنفيذها بالفعل._

## إيقاف الاختبار بعد الفشل

باستخدام خيار `bail`، يمكنك إخبار WebdriverIO بإيقاف الاختبار بعد فشل أي اختبار.

هذا مفيد مع مجموعات الاختبار الكبيرة عندما تعرف بالفعل أن البناء الخاص بك سينكسر، لكنك تريد تجنب الانتظار الطويل لتشغيل اختبار كامل.

يتوقع خيار `bail` رقمًا، يحدد عدد إخفاقات الاختبار التي يمكن أن تحدث قبل أن يوقف WebDriver تشغيل الاختبار بأكمله. الافتراضي هو `0`، مما يعني أنه يقوم دائمًا بتشغيل جميع مواصفات الاختبار التي يمكن العثور عليها.

يرجى الاطلاع على [صفحة الخيارات](configuration) للحصول على معلومات إضافية حول تكوين bail.
## تسلسل خيارات التشغيل

عند تحديد المواصفات التي سيتم تشغيلها، هناك تسلسل هرمي معين يحدد النمط الذي سيكون له الأولوية. حاليًا، هذه هي الطريقة التي تعمل بها، من أعلى أولوية إلى أدنى:

> وسيطة CLI `--spec` > نمط `specs` في القدرة > نمط `specs` في التكوين
> وسيطة CLI `--exclude` > نمط `exclude` في التكوين > نمط `exclude` في القدرة

إذا تم تقديم معلمة التكوين فقط، فسيتم استخدامها لجميع القدرات. ومع ذلك، عند تحديد النمط على مستوى القدرة، سيتم استخدامه بدلاً من نمط التكوين. أخيرًا، أي نمط مواصفات محدد في سطر الأوامر سيتجاوز جميع الأنماط الأخرى المعطاة.

### استخدام أنماط المواصفات المحددة للقدرة

عندما تقوم بتحديد نمط مواصفات على مستوى القدرة، فإنه سيتجاوز أي أنماط محددة على مستوى التكوين. هذا مفيد عند الحاجة إلى فصل الاختبارات بناءً على قدرات الأجهزة المختلفة. في حالات مثل هذه، من الأكثر فائدة استخدام نمط مواصفات عام على مستوى التكوين، وأنماط أكثر تحديدًا على مستوى القدرة.

على سبيل المثال، لنفترض أن لديك دليلين، واحد لاختبارات Android، وآخر لاختبارات iOS.

قد يحدد ملف التكوين الخاص بك النمط على النحو التالي، لاختبارات الأجهزة غير المحددة:

```js
{
    specs: ['tests/general/**/*.js']
}
```

ولكن بعد ذلك، سيكون لديك قدرات مختلفة لأجهزة Android و iOS الخاصة بك، حيث يمكن أن تبدو الأنماط مثل:

```json
{
  "platformName": "Android",
  "specs": [
    "tests/android/**/*.js"
  ]
}
```

```json
{
  "platformName": "iOS",
  "specs": [
    "tests/ios/**/*.js"
  ]
}
```

إذا كنت تتطلب كلتا هاتين القدرتين في ملف التكوين الخاص بك، فسيقوم جهاز Android بتشغيل الاختبارات الموجودة تحت مساحة الاسم "android" فقط، وستقوم اختبارات iOS بتشغيل الاختبارات الموجودة تحت مساحة الاسم "ios" فقط!

```js
//wdio.conf.js
export const config = {
    "specs": [
        "tests/general/**/*.js"
    ],
    "capabilities": [
        {
            platformName: "Android",
            specs: ["tests/android/**/*.js"],
            //...
        },
        {
            platformName: "iOS",
            specs: ["tests/ios/**/*.js"],
            //...
        },
        {
            platformName: "Chrome",
            //config level specs will be used
        }
    ]
}
```