---
id: component-testing
title: Тестування компонентів
---

З [Browser Runner](/docs/runner#browser-runner) WebdriverIO ви можете запускати тести в реальному настільному або мобільному браузері, використовуючи WebdriverIO та протокол WebDriver для автоматизації та взаємодії з вмістом, що відображається на сторінці. Цей підхід має [багато переваг](/docs/runner#browser-runner) порівняно з іншими фреймворками тестування, які дозволяють тестування лише проти [JSDOM](https://www.npmjs.com/package/jsdom).

## Як це працює?

Browser Runner використовує [Vite](https://vitejs.dev/) для рендерингу тестової сторінки та ініціалізації фреймворку тестування для запуску тестів у браузері. На даний момент підтримується лише Mocha, але Jasmine та Cucumber [знаходяться у планах](https://github.com/orgs/webdriverio/projects/1). Це дозволяє тестувати будь-які компоненти, навіть для проектів, які не використовують Vite.

Сервер Vite запускається тестраннером WebdriverIO і налаштовується таким чином, щоб ви могли використовувати всі репортери та сервіси, як ви звикли для звичайних e2e тестів. Крім того, він ініціалізує екземпляр [`browser`](/docs/api/browser), який дозволяє отримати доступ до підмножини [WebdriverIO API](/docs/api) для взаємодії з будь-якими елементами на сторінці. Подібно до e2e тестів, ви можете отримати доступ до цього екземпляра через змінну `browser`, прикріплену до глобальної області видимості, або імпортувати її з `@wdio/globals`, залежно від налаштування [`injectGlobals`](/docs/api/globals).

WebdriverIO має вбудовану підтримку наступних фреймворків:

- [__Nuxt__](https://nuxt.com/): тестраннер WebdriverIO виявляє додаток Nuxt і автоматично налаштовує композабли вашого проекту та допомагає моклувати бекенд Nuxt, детальніше в [документації Nuxt](/docs/component-testing/vue#testing-vue-components-in-nuxt)
- [__TailwindCSS__](https://tailwindcss.com/): тестраннер WebdriverIO виявляє, чи використовуєте ви TailwindCSS, і правильно завантажує середовище в тестову сторінку

## Налаштування

Щоб налаштувати WebdriverIO для модульного або компонентного тестування в браузері, ініціюйте новий проект WebdriverIO через:

```bash
npm init wdio@latest ./
# або
yarn create wdio ./
```

Після запуску конфігураційного майстра, виберіть `browser` для запуску модульного та компонентного тестування, і виберіть один із пресетів, якщо потрібно, або виберіть _"Other"_, якщо ви лише хочете запускати базові модульні тести. Ви також можете налаштувати спеціальну конфігурацію Vite, якщо ви вже використовуєте Vite у своєму проекті. Для отримання додаткової інформації перегляньте всі [параметри runner](/docs/runner#runner-options).

:::info

__Примітка:__ WebdriverIO за замовчуванням запускає тести браузера в CI в безголовому режимі, наприклад, якщо змінна середовища `CI` встановлена в `'1'` або `'true'`. Ви можете вручну налаштувати цю поведінку за допомогою опції [`headless`](/docs/runner#headless) для раннера.

:::

В кінці цього процесу ви повинні знайти `wdio.conf.js`, який містить різні конфігурації WebdriverIO, включаючи властивість `runner`, наприклад:

```ts reference useHTTPS runmeRepository="git@github.com:webdriverio/example-recipes.git" runmeFileToOpen="component-testing%2FREADME.md"
https://github.com/webdriverio/example-recipes/blob/fd54f94306ed8e7b40f967739164dfe4d6d76b41/wdio.comp.conf.js
```

Визначаючи різні [capabilities](/docs/configuration#capabilities), ви можете запускати тести в різних браузерах, паралельно, якщо потрібно.

Якщо ви все ще не впевнені, як все працює, подивіться наступний навчальний посібник про те, як почати роботу з тестуванням компонентів у WebdriverIO:

<LiteYouTubeEmbed
    id="5vp_3tGtnMc"
    title="Getting Started with Component Testing in WebdriverIO"
/>

## Тестовий стенд

Все залежить від вас, що ви хочете запускати в своїх тестах і як ви хочете рендерити компоненти. Однак ми рекомендуємо використовувати [Testing Library](https://testing-library.com/) як утилітний фреймворк, оскільки він надає плагіни для різних компонентних фреймворків, таких як React, Preact, Svelte та Vue. Він дуже корисний для рендерингу компонентів на тестовій сторінці і автоматично очищає ці компоненти після кожного тесту.

Ви можете поєднувати примітиви Testing Library з командами WebdriverIO як завгодно, наприклад:

```js reference useHTTPS
https://github.com/webdriverio/example-recipes/blob/fd54f94306ed8e7b40f967739164dfe4d6d76b41/component-testing/svelte-example.js
```

__Примітка:__ використання методів рендерингу з Testing Library допомагає видаляти створені компоненти між тестами. Якщо ви не використовуєте Testing Library, переконайтеся, що приєднуєте ваші тестові компоненти до контейнера, який очищається між тестами.

## Скрипти налаштування

Ви можете налаштувати свої тести, запускаючи довільні скрипти в Node.js або в браузері, наприклад, вставляючи стилі, моклуючи API браузера або підключаючись до стороннього сервісу. Хуки WebdriverIO [hooks](/docs/configuration#hooks) можна використовувати для запуску коду в Node.js, тоді як [`mochaOpts.require`](/docs/frameworks#require) дозволяє імпортувати скрипти в браузер перед завантаженням тестів, наприклад:

```js wdio.conf.js
export const config = {
    // ...
    mochaOpts: {
        ui: 'tdd',
        // надайте скрипт налаштування для запуску в браузері
        require: './__fixtures__/setup.js'
    },
    before: () => {
        // налаштуйте тестове середовище в Node.js
    }
    // ...
}
```

Наприклад, якщо ви хочете моклувати всі виклики [`fetch()`](https://developer.mozilla.org/en-US/docs/Web/API/fetch) у ваших тестах з наступним скриптом налаштування:

```js ./fixtures/setup.js
import { fn } from '@wdio/browser-runner'

// запустити код перед завантаженням всіх тестів
window.fetch = fn()

export const mochaGlobalSetup = () => {
    // запустити код після завантаження тестового файлу
}

export const mochaGlobalTeardown = () => {
    // запустити код після виконання файлу специфікації
}

```

Тепер у ваших тестах ви можете надавати користувацькі значення відповідей для всіх запитів браузера. Дізнайтеся більше про глобальні фікстури в [документації Mocha](https://mochajs.org/#global-fixtures).

## Відстеження тестових та прикладних файлів

Існує кілька способів, як можна налагоджувати ваші тести браузера. Найпростіший - запустити тестраннер WebdriverIO з прапорцем `--watch`, наприклад:

```sh
$ npx wdio run ./wdio.conf.js --watch
```

Це спочатку запустить всі тести і зупиниться, коли всі вони будуть виконані. Потім ви можете вносити зміни в окремі файли, які будуть повторно запускатися індивідуально. Якщо ви встановите [`filesToWatch`](/docs/configuration#filestowatch), що вказує на файли вашого додатка, він повторно запустить всі тести, коли будуть внесені зміни у ваш додаток.

## Налагодження

Хоча поки що неможливо встановити точки зупинки у вашій IDE і щоб віддалений браузер їх розпізнавав, ви можете використовувати команду [`debug`](/docs/api/browser/debug), щоб зупинити тест у будь-якій точці. Це дозволяє відкрити DevTools, а потім налагоджувати тест, встановлюючи точки зупинки у [вкладці sources](https://buddy.works/tutorials/debugging-javascript-efficiently-with-chrome-devtools).

Коли викликається команда `debug`, ви також отримуєте інтерфейс Node.js repl у вашому терміналі, який каже:

```
The execution has stopped!
You can now go into the browser or use the command line as REPL
(To exit, press ^C again or type .exit)
```

Натисніть `Ctrl` або `Command` + `c` або введіть `.exit`, щоб продовжити тест.

## Запуск з використанням Selenium Grid

Якщо у вас налаштований [Selenium Grid](https://www.selenium.dev/documentation/grid/) і ви запускаєте свій браузер через цей грід, вам потрібно встановити опцію `host` для Browser Runner, щоб дозволити браузеру отримати доступ до правильного хоста, де обслуговуються тестові файли, наприклад:

```ts title=wdio.conf.ts
export const config: WebdriverIO.Config = {
    runner: ['browser', {
        // мережевий IP-адрес машини, яка запускає процес WebdriverIO
        host: 'http://172.168.0.2'
    }]
}
```

Це забезпечить, що браузер правильно відкриє потрібний екземпляр сервера, розміщеного на екземплярі, який запускає тести WebdriverIO.

## Приклади

Ви можете знайти різні приклади тестування компонентів з використанням популярних фреймворків компонентів у нашому [репозиторії прикладів](https://github.com/webdriverio/component-testing-examples).