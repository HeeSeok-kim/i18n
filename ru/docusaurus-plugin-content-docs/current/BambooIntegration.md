---
id: bamboo
title: Bamboo
---

WebdriverIO предлагает тесную интеграцию с CI-системами, такими как [Bamboo](https://www.atlassian.com/software/bamboo). С помощью репортеров [JUnit](https://webdriver.io/docs/junit-reporter.html) или [Allure](https://webdriver.io/docs/allure-reporter.html) вы можете легко отлаживать свои тесты, а также отслеживать результаты тестирования. Интеграция довольно проста.

1. Установите JUnit репортер: `$ npm install @wdio/junit-reporter --save-dev`)
1. Обновите вашу конфигурацию, чтобы сохранять результаты JUnit там, где Bamboo может их найти (и укажите репортер `junit`):

```js
// wdio.conf.js
module.exports = {
    // ...
    reporters: [
        'dot',
        ['junit', {
            outputDir: './testresults/'
        }]
    ],
    // ...
}
```
Примечание: *Всегда хорошей практикой является хранение результатов тестов в отдельной папке, а не в корневой директории.*

```js
// wdio.conf.js - Для тестов, выполняющихся параллельно
module.exports = {
    // ...
    reporters: [
        'dot',
        ['junit', {
            outputDir: './testresults/',
            outputFileFormat: function (options) {
                return `results-${options.cid}.xml`;
            }
        }]
    ],
    // ...
}
```

Отчеты будут аналогичными для всех фреймворков, и вы можете использовать любой из них: Mocha, Jasmine или Cucumber.

К этому моменту мы предполагаем, что у вас уже написаны тесты, результаты генерируются в папке ```./testresults/```, и ваш Bamboo запущен и работает.

## Интеграция ваших тестов в Bamboo

1. Откройте ваш проект Bamboo
    > Создайте новый план, привяжите свой репозиторий (убедитесь, что он всегда указывает на новейшую версию вашего репозитория) и создайте этапы

    ![Plan Details](/img/bamboo/plancreation.png "Plan Details")

    Я буду использовать этап и задачу по умолчанию. В вашем случае вы можете создать собственные этапы и задачи

    ![Default Stage](/img/bamboo/defaultstage.png "Default Stage")
2. Откройте вашу тестовую задачу и создайте задания для запуска тестов в Bamboo
    >**Задание 1:** Выгрузка исходного кода

    >**Задание 2:** Запустите ваши тесты ```npm i && npm run test```. Вы можете использовать задание *Script* и *Shell Interpreter* для выполнения вышеуказанных команд (это сгенерирует результаты тестов и сохранит их в папке ```./testresults/```)

    ![Test Run](/img/bamboo/testrun.png "Test Run")

    >**Задание: 3** Добавьте задание *jUnit Parser* для анализа сохраненных результатов тестов. Укажите здесь директорию с результатами тестов (вы также можете использовать шаблоны в стиле Ant)

    ![jUnit Parser](/img/bamboo/junitparser.png "jUnit Parser")

    Примечание: *Убедитесь, что вы размещаете задание анализа результатов в разделе *Final*, чтобы оно всегда выполнялось, даже если задание с тестами завершилось с ошибкой*

    >**Задание: 4** (опционально) Чтобы ваши результаты тестов не смешивались со старыми файлами, вы можете создать задание для удаления папки ```./testresults/``` после успешного анализа в Bamboo. Вы можете добавить скрипт оболочки, например ```rm -f ./testresults/*.xml``` для удаления результатов или ```rm -r testresults``` для удаления всей папки

После завершения вышеописанной "ракетной науки", включите план и запустите его. Ваш конечный результат будет выглядеть так:

## Успешный тест

![Successful Test](/img/bamboo/successfulltest.png "Successful Test")

## Неудачный тест

![Failed Test](/img/bamboo/failedtest.png "Failed Test")

## Неудачный и исправленный

![Failed and Fixed](/img/bamboo/failedandfixed.png "Failed and Fixed")

Ура!! Вот и всё. Вы успешно интегрировали свои тесты WebdriverIO в Bamboo.