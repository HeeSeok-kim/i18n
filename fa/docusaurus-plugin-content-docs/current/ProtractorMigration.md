---
id: protractor-migration
title: از Protractor
---

این آموزش برای افرادی است که از Protractor استفاده می‌کنند و می‌خواهند چارچوب خود را به WebdriverIO مهاجرت دهند. این آموزش پس از آنکه تیم Angular [اعلام کرد](https://github.com/angular/protractor/issues/5502) که Protractor دیگر پشتیبانی نخواهد شد، آغاز شد. WebdriverIO از بسیاری از تصمیمات طراحی Protractor تأثیر پذیرفته است که به همین دلیل احتمالاً نزدیک‌ترین چارچوب برای مهاجرت است. تیم WebdriverIO از کار تمام مشارکت‌کنندگان Protractor قدردانی می‌کند و امیدوار است که این آموزش، انتقال به WebdriverIO را آسان و مستقیم سازد.

اگرچه ما دوست داریم یک فرآیند کاملاً خودکار برای این کار داشته باشیم، اما واقعیت متفاوت است. هر کس تنظیمات متفاوتی دارد و از Protractor به روش‌های مختلفی استفاده می‌کند. هر مرحله باید به عنوان راهنمایی دیده شود و نه دستورالعمل گام به گام. اگر در مهاجرت مشکلی دارید، از [تماس با ما](https://github.com/webdriverio/codemod/discussions/new) دریغ نکنید.

## راه‌اندازی

API های Protractor و WebdriverIO در واقع بسیار شبیه هستند، تا حدی که اکثر دستورات را می‌توان به صورت خودکار از طریق [codemod](https://github.com/webdriverio/codemod) بازنویسی کرد.

برای نصب codemod، اجرا کنید:

```sh
npm install jscodeshift @wdio/codemod
```

## استراتژی

استراتژی‌های مهاجرت زیادی وجود دارد. بسته به اندازه تیم شما، تعداد فایل‌های آزمون و فوریت مهاجرت، می‌توانید سعی کنید تمام آزمون‌ها را یکباره یا فایل به فایل تبدیل کنید. با توجه به اینکه Protractor تا نسخه ۱۵ Angular (پایان سال ۲۰۲۲) همچنان نگهداری خواهد شد، هنوز زمان کافی دارید. می‌توانید آزمون‌های Protractor و WebdriverIO را همزمان اجرا کنید و شروع به نوشتن آزمون‌های جدید در WebdriverIO کنید. با توجه به بودجه زمانی خود، می‌توانید ابتدا مهاجرت موارد آزمون مهم را شروع کنید و به سمت آزمون‌هایی پیش بروید که حتی ممکن است بتوانید آنها را حذف کنید.

## ابتدا فایل پیکربندی

پس از نصب codemod، می‌توانیم تبدیل اولین فایل را شروع کنیم. ابتدا به [گزینه‌های پیکربندی WebdriverIO](configuration) نگاهی بیندازید. فایل‌های پیکربندی می‌توانند بسیار پیچیده شوند و ممکن است منطقی باشد که فقط بخش‌های ضروری را منتقل کنید و ببینید چگونه می‌توان بقیه را پس از مهاجرت آزمون‌های مربوطه که به گزینه‌های خاصی نیاز دارند، اضافه کرد.

برای اولین مهاجرت، فقط فایل پیکربندی را تبدیل می‌کنیم و اجرا می‌کنیم:

```sh
npx jscodeshift -t ./node_modules/@wdio/codemod/protractor ./conf.ts
```

:::info

نام پیکربندی شما ممکن است متفاوت باشد، اما اصل باید یکسان باشد: مهاجرت را با پیکربندی شروع کنید.

:::

## نصب وابستگی‌های WebdriverIO

مرحله بعدی پیکربندی یک تنظیم حداقلی WebdriverIO است که ما شروع به ساخت آن می‌کنیم همانطور که از یک چارچوب به چارچوب دیگر مهاجرت می‌کنیم. ابتدا CLI WebdriverIO را از طریق زیر نصب می‌کنیم:

```sh
npm install --save-dev @wdio/cli
```

سپس ویزارد پیکربندی را اجرا می‌کنیم:

```sh
npx wdio config
```

این شما را از چند سؤال عبور می‌دهد. برای این سناریو مهاجرت:
- انتخاب‌های پیش‌فرض را انتخاب کنید
- توصیه می‌کنیم فایل‌های نمونه به طور خودکار ایجاد نشوند
- پوشه متفاوتی برای فایل‌های WebdriverIO انتخاب کنید
- و Mocha را به جای Jasmine انتخاب کنید.

:::info چرا Mocha؟
اگرچه ممکن است قبلاً از Protractor با Jasmine استفاده کرده باشید، اما Mocha مکانیزم‌های تلاش مجدد بهتری ارائه می‌دهد. انتخاب با شماست!
:::

پس از پرسشنامه کوچک، ویزارد تمام بسته‌های لازم را نصب می‌کند و آن‌ها را در `package.json` شما ذخیره می‌کند.

## مهاجرت فایل پیکربندی

پس از اینکه یک `conf.ts` تبدیل شده و یک `wdio.conf.ts` جدید داریم، اکنون زمان آن است که پیکربندی را از یک پیکربندی به دیگری منتقل کنیم. مطمئن شوید که فقط کدی را منتقل می‌کنید که برای اجرای همه آزمون‌ها ضروری است. در مورد ما، ما توابع هوک و زمان انقضای چارچوب را منتقل می‌کنیم.

ما اکنون فقط با فایل `wdio.conf.ts` خود ادامه خواهیم داد و بنابراین دیگر نیازی به تغییرات در پیکربندی اصلی Protractor نخواهیم داشت. می‌توانیم آن‌ها را بازگردانیم تا هر دو چارچوب بتوانند در کنار هم اجرا شوند و ما بتوانیم در هر زمان یک فایل را منتقل کنیم.

## مهاجرت فایل آزمون

اکنون آماده انتقال اولین فایل آزمون هستیم. برای شروع ساده، با فایلی شروع کنیم که وابستگی زیادی به بسته‌های شخص ثالث یا فایل‌های دیگر مانند PageObjects ندارد. در مثال ما، اولین فایل برای مهاجرت `first-test.spec.ts` است. ابتدا دایرکتوری‌ای را ایجاد کنید که پیکربندی جدید WebdriverIO فایل‌های خود را در آن انتظار دارد و سپس آن را منتقل کنید:

```sh
mv mkdir -p ./test/specs/
mv test-suites/first-test.spec.ts ./test/specs
```

حالا بیایید این فایل را تبدیل کنیم:

```sh
npx jscodeshift -t ./node_modules/@wdio/codemod/protractor ./test/specs/first-test.spec.ts
```

همین! این فایل آنقدر ساده است که دیگر نیازی به تغییرات اضافی نداریم و می‌توانیم مستقیماً اجرای WebdriverIO را امتحان کنیم:

```sh
npx wdio run wdio.conf.ts
```

تبریک می‌گویم 🥳 شما همین الان اولین فایل را مهاجرت دادید!

## مراحل بعدی

از این نقطه به بعد به تبدیل آزمون به آزمون و ابژه صفحه به ابژه صفحه ادامه می‌دهید. احتمال دارد که codemod برای فایل‌های خاصی با خطایی مانند زیر شکست بخورد:

```
ERR /path/to/project/test/testdata/failing_submit.js Transformation error (Error transforming /test/testdata/failing_submit.js:2)
Error transforming /test/testdata/failing_submit.js:2

> login_form.submit()
  ^

The command "submit" is not supported in WebdriverIO. We advise to use the click command to click on the submit button instead. For more information on this configuration, see https://webdriver.io/docs/api/element/click.
  at /path/to/project/test/testdata/failing_submit.js:132:0
```

برای برخی از دستورات Protractor، جایگزینی در WebdriverIO وجود ندارد. در این مورد codemod به شما توصیه‌هایی درباره چگونگی بازسازی آن می‌دهد. اگر خیلی با چنین پیام‌های خطایی مواجه می‌شوید، لطفاً [یک مسئله ایجاد کنید](https://github.com/webdriverio/codemod/issues/new) و درخواست اضافه کردن یک تبدیل خاص را بدهید. در حالی که codemod در حال حاضر اکثر API های Protractor را تبدیل می‌کند، هنوز فضای زیادی برای بهبود وجود دارد.

## نتیجه‌گیری

امیدواریم این آموزش شما را در فرآیند مهاجرت به WebdriverIO کمی راهنمایی کند. جامعه به بهبود codemod ادامه می‌دهد در حالی که آن را با تیم‌های مختلف در سازمان‌های مختلف آزمایش می‌کند. اگر بازخورد دارید از [طرح یک مسئله](https://github.com/webdriverio/codemod/issues/new) یا اگر در فرآیند مهاجرت با مشکل مواجه هستید از [شروع یک گفتگو](https://github.com/webdriverio/codemod/discussions/new) دریغ نکنید.